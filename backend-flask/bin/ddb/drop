#! /usr/bin/bash

set -e

if [ -z "$1" ]; then # if param #1 doesn't exist.
  echo "No TABLE_NAME argument supplied eg ./bin/ddb/drop cruddur-messages prod "
  exit 1
fi
TABLE_NAME=$1


if [ "$2" = "prod" ]; then # if param #2 equals to "prod".
  ENDPOINT_URL=""
else
  ENDPOINT_URL="--endpoint-url=http://localhost:8000"
fi

echo "deleting table: $TABLE_NAME"

aws dynamodb delete-table $ENDPOINT_URL \
  --table-name $TABLE_NAME

# Check if the table exists
# aws dynamodb describe-table $ENDPOINT_URL --table-name $TABLE_NAME >/dev/null 2>&1

# if [ $? -eq 0 ]; then
#     echo "Table $TABLE_NAME exists. Deleting..."
#     aws dynamodb delete-table $ENDPOINT_URL --table-name $TABLE_NAME
#     echo "Table $TABLE_NAME deleted."
# else
#     echo "Table $TABLE_NAME does not exist."
# fi

exit 0
